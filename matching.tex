\section{Computing Matching Schemes}
\label{sec:matching}

TODO MOTIVATE THIS SECTION

When $P$ is a $k$-length sequence of $n$-ary predicates, we write $P(x_1,
\ldots, x_n)$ to denote the valuation sequence
\begin{align*}
  P_1(x_1, \ldots, x_n) \ldots P_k(x_1, \ldots, x_n).
\end{align*}
Given finite predicate sequences $P$ and $Q$ and a set $E$ of executions, a
matching scheme $M$ is \emph{simple} when there exists an $n$-ary Boolean
function $G$, for $n = 2\cdot|P|+|Q|$, such that for each execution $e \in E$
\begin{itemize}

  \item $G(P(e,o_1),P(e,o_2),Q(e,o_1,o_2))$ is satisfied for at most one
  operation $o_1$, for any operation $o_2$,

  \item $M(e)(o_2)$ is undefined unless there exists an operation $o_1$
  for which $G(P(e,o_1),P(e,o_2),Q(e,o_1,o_2))$, and

  \item $M(e)(o_2) = o_1$ if{f} $G(P(e,o_1),P(e,o_2),P(e,o_1,o_2))$,

\end{itemize}
where $o_1$ and $o_2$ range over the operations of $e$.

TODO QUALIFY THE EXECUTION SETS, E.G., TO HAVE UNIQUE VALUES, AND SO ON

\begin{example}

  We say an execution of the atomic register ADT \emph{writes unique values}
  if the argument value to each write operation is unique. Consider the set $E$
  of executions which write unique values, and the following predicates:
  \begin{align*}
    & \mathsf{write}(e,o) & \text{$o$ is a {\sf write} operation in $e$}, \\
    & \mathsf{read}(e,o) & \text{$o$ is a {\sf read} operation in $e$,} \\
    & \mathsf{eq}(e,o_1,o_2) & \text{$o_1$ and $o_2$ the same operation, and} \\
    & \mathsf{veq}(e,o_1,o_2) & \text{$o_1$ and $o_2$ read/write the same values.}
  \end{align*}
  Given a valuation $\tup{x_\mathsf{w}, x_\mathsf{r}, y_\mathsf{w},
  y_\mathsf{r}, z_\mathsf{=}, z_\mathsf{v}}$ of the predicates above, we define
  the function $G(x_\mathsf{w}, x_\mathsf{r}, y_\mathsf{w}, y_\mathsf{r},
  z_\mathsf{=}, z_\mathsf{v})$ to be satisfied if and only if:
  \begin{align*}
    \big( x_\mathsf{w} \land z_\mathsf{=} \big)
    \lor \big( x_\mathsf{w} \land y_\mathsf{r} \land z_\mathsf{v} \big)
  \end{align*}
  Intuitively, this defines a simple matching scheme for which write operations
  match themselves, and read operations match the write which wrote the value
  read. In the case such a write exists, it is unique in any execution which
  writes unique values. The match is otherwise undefined.

  TODO ARGUE THAT THIS IS A FAITHFUL MATCHING SCHEME 

\end{example}

\begin{definition}

  The \emph{matching scheme inference problem} is to compute a faithful, simple
  matching scheme $M$ for a given set $E$ of executions and finite predicate
  sequences $P$ and $Q$.

\end{definition}

\begin{theorem}

  The matching scheme inference problem is computable for \ldots

\end{theorem}
