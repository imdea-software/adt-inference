\section{Algebraic Properties of ADTs}
\label{sec:algebra}

TODO MOTIVATE THIS SECTION

The ADTs we consider in this work are also closed under the additional
relations $\to_\mathrm{m}$ and $\to_\mathrm{d}$ which relate two histories
$h_1$ and $h_2$ when $h_2$ is obtained from $h_1$ by
\begin{itemize}

  \item removing a match (m), or

  \item removing a duplicate operation (d).

\end{itemize}
We say an ADT closed under $\to_\mathrm{m}$ and $\to_\mathrm{d}$ is
\emph{normal}. In Section~\ref{sec:nature} we demonstrate that
naturally-occurring ADTs are normal. Defining the relation $\succeq$ as the
reflexive and transitive closure of the above relations
\begin{align*}
  \succeq = (\to_\mathrm{o} \cup \to_\mathrm{p} \cup \to_\mathrm{c} \cup 
  \to_\mathrm{m} \cup \to_\mathrm{d})^\ast,
\end{align*}
closure under $\succeq$ follows immediately.

\begin{lemma}

  Normal ADTs are closed under $\succeq$.

\end{lemma}

TODO DEFINE WQO, FINITELY-REPRESENTABLE, COMPUTABLE

\begin{example}

  Consider the infinite history sequence $h_1 h_2 \ldots$ where each $h_i$
  contains $2i$ operations $o_1, o_1', \ldots, o_i, o_i'$ where each $o_j$ is a
  completed {\tt push} operation matching itself, and each $o_j'$ is a pending
  {\tt pop} operation with undefined matching. Because each successive $h_i$
  has both more matches and more pending operations, no two histories of the
  sequence are related by $\preceq$. Thus $\preceq$ is not a wqo.

\end{example}

The previous example demonstrates that $\preceq$ is not a wqo by allowing each
history $h_i$ of the infinite sequence to contain more and more pending
operations in order to ensure that $h_j \not\preceq h_i$ for every $j < i$.
Curbing this ability by limiting the maximum amount of pending operations per
history makes $\preceq$ a wqo. Although limiting to $k$ pending operations
essentially limits us to histories of executions with at most $k$ operations
parallel at any moment — e.g.,~of programs with at most $k$ threads — this
restriction comes at no loss of completeness when considering atomic ATD
kernels, whose histories are limited to $k\!=\!1$ pending operation.

TODO COMMENT ON CONCURRENCY-AWARE KERNELS

\begin{lemma}

  $\preceq$ is a wqo on the set of histories with at most $k$ pending
  operations, for any $k \in \mathbb{N}$.

\end{lemma}

For the remainder of this section, we fix an ADT $A$, and let $B$ be the
complement of $\ker A$.

\begin{lemma}

  $B$ is finitely representable if $A$ is normal.

\end{lemma}

For all $i \in \mathbb{N}$, let
\begin{align*}
  B_i &= \set{ h \in B : \_ \le i } \\
  B_i' &= \set{ h' \in B :
    \exists h \in B_i.\ h \preceq h' \text{ and } \_ \le i+1
  }
\end{align*}
be, respectively, the histories of $B$ with at most $i$ matches, and those
derived from $B_i$ with at most $i\!+\!1$ matches. We say that $A$ is
\emph{predictable} if $B_i = B$ whenever $B_i' = B_{i+1}$. In 
Section~\ref{sec:nature} we demonstrate that naturally-occurring ADTs are
predictable.

\begin{lemma}

  $B_i$ is computable, for all $i \in \mathbb{N}$, if $A$ is normal.

\end{lemma}

\begin{lemma}

  $B$ is computable if $A$ is normal and predictable.

\end{lemma}
